List of commands provided by smoothd - these replace previous commands carried out by setuid wrappers.
Smoothd is more secure as communication from the user is by message passing, not direct invocation.


Command		Parameters	Source File		Notes		
advnetset			sysadvnet.cpp		depends on files /var/smoothwall/advnet/[noping,cookies,noigmp,nomulticast] 
							get different combo of iptables rules if these files are present or not.
alcateladslfw			sysalcatel.cpp		depends on /var/smoothwall/adsl/mgmt.o - if present will pass it to /usr/bin/modem_run

dhcpdrestart
dhcpdstart
dhcpdstop			sysdhcpd.cpp		depends on files /var/smoothwall/dhcp/[green,purple,enable] the first two files contain params to 
							params to dhcpd and enable just has to be present - contents not important


dmzholeset			sysdmzholes.cpp		depeneds on CSV config file /var/smoothwall/dmzholes/config

dnsproxyrestart
dnsproxystop
dnsproxystart	2 dns IPs	sysdnsproxy.cpp		writes /etc/resolv.conf.dnsmasq then invokes /usr/bin/dnsmasq

ipsecrestart
ipsecstop
ipsecstart			sysipsec.cpp		
imrestart
imstop
imstart				sysim.cpp		depends on CSV file /var/smoothwall/im/settings, Writes iptables rules according to settings
							before starting imspector.

install		patch num	sysinstall.cpp		runs /var/patches/(patch num)/setup as root then removes the /var/patches/(patch num directory.
							NEEDS some form of checksum validation on the script being run.


ipblockset			sysipblock.cpp		depends on CSV file /var/smoothwall/ipblock/config, sets iptables rules accordingly.

ntpdrestart
ntpdstop
ntpdstart			sysntpd.cpp		depends on /var/smoothwall/time/enablentpd - if this is not present ntpd is not started

outboundset			sysoutbound.cpp		depends on CSV file /var/smoothwall/outbound/config. Writes iptables rules according to settings

portfwset			sysportfw.cpp		depends on CSV file /var/smoothwall/portfw/config and data files /var/smoothwall/red/local-ipaddress 
							and /var/smoothwall/red/iface.  Writes iptables rules according to settings.
systemrestart
systemshutdown
systemcancel	time		sysshutdown.cpp

snortrestart
snortstop
snortstart			syssnort.cpp		depends on data files /var/smoothwall/red/[iface,dns1,dns2,local-ipaddresses]. Uses these to write
							/etc/snort/vars. If the /var/smoothwall/snort/enable file exists then snort is started.

squidrestart
squidstop
squidstart			syssquid.cpp		depends on flag files /var/smoothwall/proxy/[clearedcache, transparent, enable]. Starts squid appropriatley.

sshdrestart
sshdstop
sshdstart			sysssh.cpp		if /var/smoothwall/remote/enablessh exists starts sshd.

updown		UP		sysupdown.cpp		if paremeter is UP /usr/bin/smoothwall/ppp-on else  /usr/bin/smoothwall/ppp-off

upnpdrestart
upnpdstop
upnpdstart			sysupnpd.cpp		if flag file /var/smoothwall/advnet/upnp present runs /usr/sbin/upnpd for contents of /var/smoothwall/red/iface.

xtaccessset			sysxtaccess.cpp		depends on CSV file /var/smoothwall/xtaccess/config. Writes iptables rules according to settings.